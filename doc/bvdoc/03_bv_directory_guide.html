<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <meta content="text/html; charset=UTF-8" http-equiv="Content-Type" />

  <title>File: 03_bv_directory_guide [RDoc Documentation]</title>

  <link type="text/css" media="screen" href="../rdoc.css" rel="stylesheet" />

  <script src="../js/jquery.js" type="text/javascript"
    charset="utf-8"></script>
  <script src="../js/thickbox-compressed.js" type="text/javascript"
    charset="utf-8"></script>
  <script src="../js/quicksearch.js" type="text/javascript"
    charset="utf-8"></script>
  <script src="../js/darkfish.js" type="text/javascript"
    charset="utf-8"></script>
</head>

<body class="file">
  <div id="metadata">
    <div id="home-metadata">
      <div id="home-section" class="section">
        <h3 class="section-header">
          <a href="../index.html">Home</a>
          <a href="../index.html#classes">Classes</a>
          <a href="../index.html#methods">Methods</a>
        </h3>
      </div>
    </div>

    <div id="project-metadata">
      
      
      <div id="fileindex-section" class="section project-section">
        <h3 class="section-header">Files</h3>
        <ul>
        
          <li class="file"><a href="../Gemfile.html">Gemfile</a></li>
        
          <li class="file"><a href="../Rakefile.html">Rakefile</a></li>
        
          <li class="file"><a href="../UserGuide.html">UserGuide</a></li>
        
          <li class="file"><a href="../bvdoc/00_bv_oauth_guide.html">00_bv_oauth_guide</a></li>
        
          <li class="file"><a href="../bvdoc/01_bv_advertising_guide.html">01_bv_advertising_guide</a></li>
        
          <li class="file"><a href="../bvdoc/02_bv_location_guide.html">02_bv_location_guide</a></li>
        
          <li class="file"><a href="../bvdoc/03_bv_directory_guide.html">03_bv_directory_guide</a></li>
        
          <li class="file"><a href="../bvdoc/04_bv_payment_guide.html">04_bv_payment_guide</a></li>
        
          <li class="file"><a href="../bvdoc/05_bv_sms_mt_guide.html">05_bv_sms_mt_guide</a></li>
        
          <li class="file"><a href="../bvdoc/06_bv_mms_mt_guide.html">06_bv_mms_mt_guide</a></li>
        
          <li class="file"><a href="../bvdoc/07_bv_sms_mo_guide.html">07_bv_sms_mo_guide</a></li>
        
          <li class="file"><a href="../bvdoc/08_bv_mms_mo_guide.html">08_bv_mms_mo_guide</a></li>
        
        </ul>
      </div>
      

      <div id="classindex-section" class="section project-section">
        <h3 class="section-header">Class Index
          <span class="search-toggle"><img src="../images/find.png"
            height="16" width="16" alt="[+]"
            title="show/hide quicksearch" /></span></h3>
        <form action="#" method="get" accept-charset="utf-8" class="initially-hidden">
        <fieldset>
          <legend>Quicksearch</legend>
          <input type="text" name="quicksearch" value=""
            class="quicksearch-field" />
        </fieldset>
        </form>

        <ul class="link-list">
        
          <li><a href="../Bluevia.html">Bluevia</a></li>
        
          <li><a href="../Bluevia/BVAdvertising.html">Bluevia::BVAdvertising</a></li>
        
          <li><a href="../Bluevia/BVAdvertisingClient.html">Bluevia::BVAdvertisingClient</a></li>
        
          <li><a href="../Bluevia/BVBaseClient.html">Bluevia::BVBaseClient</a></li>
        
          <li><a href="../Bluevia/BVDirectory.html">Bluevia::BVDirectory</a></li>
        
          <li><a href="../Bluevia/BVDirectoryClient.html">Bluevia::BVDirectoryClient</a></li>
        
          <li><a href="../Bluevia/BVLocation.html">Bluevia::BVLocation</a></li>
        
          <li><a href="../Bluevia/BVLocationClient.html">Bluevia::BVLocationClient</a></li>
        
          <li><a href="../Bluevia/BVMoClient.html">Bluevia::BVMoClient</a></li>
        
          <li><a href="../Bluevia/BVMoMms.html">Bluevia::BVMoMms</a></li>
        
          <li><a href="../Bluevia/BVMoMmsClient.html">Bluevia::BVMoMmsClient</a></li>
        
          <li><a href="../Bluevia/BVMoSms.html">Bluevia::BVMoSms</a></li>
        
          <li><a href="../Bluevia/BVMoSmsClient.html">Bluevia::BVMoSmsClient</a></li>
        
          <li><a href="../Bluevia/BVMode.html">Bluevia::BVMode</a></li>
        
          <li><a href="../Bluevia/BVMtClient.html">Bluevia::BVMtClient</a></li>
        
          <li><a href="../Bluevia/BVMtMms.html">Bluevia::BVMtMms</a></li>
        
          <li><a href="../Bluevia/BVMtMmsClient.html">Bluevia::BVMtMmsClient</a></li>
        
          <li><a href="../Bluevia/BVMtSms.html">Bluevia::BVMtSms</a></li>
        
          <li><a href="../Bluevia/BVMtSmsClient.html">Bluevia::BVMtSmsClient</a></li>
        
          <li><a href="../Bluevia/BVOauth.html">Bluevia::BVOauth</a></li>
        
          <li><a href="../Bluevia/BVOauthClient.html">Bluevia::BVOauthClient</a></li>
        
          <li><a href="../Bluevia/BVPayment.html">Bluevia::BVPayment</a></li>
        
          <li><a href="../Bluevia/BlueviaError.html">Bluevia::BlueviaError</a></li>
        
          <li><a href="../Bluevia/ConnectionError.html">Bluevia::ConnectionError</a></li>
        
          <li><a href="../Bluevia/Errors.html">Bluevia::Errors</a></li>
        
          <li><a href="../Bluevia/IConnector.html">Bluevia::IConnector</a></li>
        
          <li><a href="../Bluevia/IConnector/BVHttpOAuthConnector.html">Bluevia::IConnector::BVHttpOAuthConnector</a></li>
        
          <li><a href="../Bluevia/IParser.html">Bluevia::IParser</a></li>
        
          <li><a href="../Bluevia/IParser/JsonParser.html">Bluevia::IParser::JsonParser</a></li>
        
          <li><a href="../Bluevia/IParser/JsonRpcParser.html">Bluevia::IParser::JsonRpcParser</a></li>
        
          <li><a href="../Bluevia/IParser/MultipartParser.html">Bluevia::IParser::MultipartParser</a></li>
        
          <li><a href="../Bluevia/IParser/XmlParser.html">Bluevia::IParser::XmlParser</a></li>
        
          <li><a href="../Bluevia/ISerializer.html">Bluevia::ISerializer</a></li>
        
          <li><a href="../Bluevia/ISerializer/JsonRpcSerializer.html">Bluevia::ISerializer::JsonRpcSerializer</a></li>
        
          <li><a href="../Bluevia/ISerializer/JsonSerializer.html">Bluevia::ISerializer::JsonSerializer</a></li>
        
          <li><a href="../Bluevia/ISerializer/MultipartSerializer.html">Bluevia::ISerializer::MultipartSerializer</a></li>
        
          <li><a href="../Bluevia/ISerializer/UrlEncodedSerializer.html">Bluevia::ISerializer::UrlEncodedSerializer</a></li>
        
          <li><a href="../Bluevia/Schemas.html">Bluevia::Schemas</a></li>
        
          <li><a href="../Bluevia/Schemas/AccessFields.html">Bluevia::Schemas::AccessFields</a></li>
        
          <li><a href="../Bluevia/Schemas/AccessInfo.html">Bluevia::Schemas::AccessInfo</a></li>
        
          <li><a href="../Bluevia/Schemas/Attachment.html">Bluevia::Schemas::Attachment</a></li>
        
          <li><a href="../Bluevia/Schemas/AttachmentInfo.html">Bluevia::Schemas::AttachmentInfo</a></li>
        
          <li><a href="../Bluevia/Schemas/BVResponse.html">Bluevia::Schemas::BVResponse</a></li>
        
          <li><a href="../Bluevia/Schemas/CreativeElement.html">Bluevia::Schemas::CreativeElement</a></li>
        
          <li><a href="../Bluevia/Schemas/DeliveryInfo.html">Bluevia::Schemas::DeliveryInfo</a></li>
        
          <li><a href="../Bluevia/Schemas/DirectoryDataSets.html">Bluevia::Schemas::DirectoryDataSets</a></li>
        
          <li><a href="../Bluevia/Schemas/LocationInfo.html">Bluevia::Schemas::LocationInfo</a></li>
        
          <li><a href="../Bluevia/Schemas/MimeContent.html">Bluevia::Schemas::MimeContent</a></li>
        
          <li><a href="../Bluevia/Schemas/MmsMessage.html">Bluevia::Schemas::MmsMessage</a></li>
        
          <li><a href="../Bluevia/Schemas/MmsMessageInfo.html">Bluevia::Schemas::MmsMessageInfo</a></li>
        
          <li><a href="../Bluevia/Schemas/PaymentResult.html">Bluevia::Schemas::PaymentResult</a></li>
        
          <li><a href="../Bluevia/Schemas/PaymentStatus.html">Bluevia::Schemas::PaymentStatus</a></li>
        
          <li><a href="../Bluevia/Schemas/PersonalFields.html">Bluevia::Schemas::PersonalFields</a></li>
        
          <li><a href="../Bluevia/Schemas/PersonalInfo.html">Bluevia::Schemas::PersonalInfo</a></li>
        
          <li><a href="../Bluevia/Schemas/Profile.html">Bluevia::Schemas::Profile</a></li>
        
          <li><a href="../Bluevia/Schemas/ProfileFields.html">Bluevia::Schemas::ProfileFields</a></li>
        
          <li><a href="../Bluevia/Schemas/ProtectionPolicy.html">Bluevia::Schemas::ProtectionPolicy</a></li>
        
          <li><a href="../Bluevia/Schemas/RequestToken.html">Bluevia::Schemas::RequestToken</a></li>
        
          <li><a href="../Bluevia/Schemas/SimpleAdResponse.html">Bluevia::Schemas::SimpleAdResponse</a></li>
        
          <li><a href="../Bluevia/Schemas/SmsMessage.html">Bluevia::Schemas::SmsMessage</a></li>
        
          <li><a href="../Bluevia/Schemas/TerminalFields.html">Bluevia::Schemas::TerminalFields</a></li>
        
          <li><a href="../Bluevia/Schemas/TerminalInfo.html">Bluevia::Schemas::TerminalInfo</a></li>
        
          <li><a href="../Bluevia/Schemas/TypeId.html">Bluevia::Schemas::TypeId</a></li>
        
          <li><a href="../Bluevia/Schemas/UserIdType.html">Bluevia::Schemas::UserIdType</a></li>
        
          <li><a href="../Bluevia/Schemas/UserInfo.html">Bluevia::Schemas::UserInfo</a></li>
        
          <li><a href="../Bluevia/Utils.html">Bluevia::Utils</a></li>
        
          <li><a href="../OAuth.html">OAuth</a></li>
        
          <li><a href="../OAuth/Client.html">OAuth::Client</a></li>
        
          <li><a href="../OAuth/Client/Helper.html">OAuth::Client::Helper</a></li>
        
          <li><a href="../Rack.html">Rack</a></li>
        
          <li><a href="../Rack/Multipart.html">Rack::Multipart</a></li>
        
          <li><a href="../Rack/Multipart/Parser.html">Rack::Multipart::Parser</a></li>
        
          <li><a href="../BlueviaLogger.html">BlueviaLogger</a></li>
        
          <li><a href="../DemoAdvertising.html">DemoAdvertising</a></li>
        
          <li><a href="../DemoDirectory.html">DemoDirectory</a></li>
        
          <li><a href="../DemoLocation.html">DemoLocation</a></li>
        
          <li><a href="../DemoMmsMo.html">DemoMmsMo</a></li>
        
          <li><a href="../DemoMmsMt.html">DemoMmsMt</a></li>
        
          <li><a href="../DemoOauth.html">DemoOauth</a></li>
        
          <li><a href="../DemoPayment.html">DemoPayment</a></li>
        
          <li><a href="../DemoSmsMo.html">DemoSmsMo</a></li>
        
          <li><a href="../DemoSmsMt.html">DemoSmsMt</a></li>
        
          <li><a href="../Hash.html">Hash</a></li>
        
          <li><a href="../Object.html">Object</a></li>
        
        </ul>
        <div id="no-class-search-results" style="display: none;">No matching classes.</div>
      </div>

      
    </div>
  </div>

  <div id="documentation">
    
<p><a href="../Bluevia.html">Bluevia</a> Directory Client Guide</p>

<p>Introduction</p>

<pre>Bluevia Directory API is a set of functions which allows users to retrieve 
user-related information, divided in four blocks (user profile, access information, 
personal information and terminal information). 
This guide represents a practical introduction to developing applications in which
user wants to provide the Bluevia Directory functionality.</pre>

<p>Directory client basics</p>

<pre>A Directory client represents the client side in a classic client-server schema. 
This object wraps up the underlying REST client side functionality needed to perform 
requests against a REST server. 

Any Bluevia client performs requests and receives responses in a secure mode. Clients 
are authorized following the OAuth protocol. This security protocol enables users to 
grant third-party access to their resources without sharing their passwords. So 
clients store the authorization data -called security credentials- to grant access 
to the server.

Following sections describe the security credentials we are talking about.</pre>

<p>Creating a Directory client: BVDirectory class</p>

<pre>First step for using Directory client is to create a BVDirectory object. This object 
can have three different working modes: 

- LIVE or BVMODE::LIVE Your application uses real network, which means that you will 
  be able to send real transactions to real Movistar, O2 and Vivo customers in the
  applicable country.
- TEST or BVMODE::TEST Behave exactly likes Live mode, but API calls are free of 
  chargue, using a credits system. You are required to have a Movistar, O2 or Vivo 
  mobile number to get this monthly credits.
- SANDBOX or BVMODE::SANDBOX Sandbox environment offers you the exact same experience 
  as Live environment except that no traffic is generated on live network.</pre>

<p>Directory client features: security credentials</p>

<pre>Bluevia uses OAuth as its authentication mechanism which enables websites and 
applications to access Bluevia API's without end users disclosing their personal 
credentials.

In order to grant access to the server any client has to be created passing the 
security credential as parameter in its constructor. These security credentials 
are managed internally and added as a HTTP header in every request sent to the server.

Such Oauth security credentials are:

    - Consumer key: String identifying the application (obtained when you registered 
      your application within the provisioning portal.
    - Consumer secret: A secret -a string- used by the consumer to establish ownership 
      of the consumer key.
    - Access token: Token -a string- used by the client for granting access permissions 
      to the server.
    - Access token secret: The secret of the access token.</pre>

<p>Directory client features: code example</p>

<pre>Find below an example on how to create an Oauth 3-legged Directory client taking 
into account all the information previously given.

# three-legged directory client
@bc = BVDirectory.new(BVMode::LIVE, &quot;[CONSUMER_KEY]&quot;,&quot;[CONSUMER_SECRET]&quot;,
                                            &quot;[TOKEN_KEY]&quot;,&quot;[TOKEN_SECRET]&quot;)</pre>

<p>Retrieving User Info</p>

<pre>Use these lines to get all available user info

  response = @bc.get_user_info

Returns a Bluevia::Schemas::UserInfo object that contains four objects with 
different information required (PersonalInfo, Profile, TerminalInfo and AccessInfo)</pre>

<p>Selecting blocks in requests</p>

<pre>In case the user doesn't want to retrieve all blocks, there is an option to 
retrieve only a subset of the available information, using filters. An array 
of DataSets can be included in the request selecting the desired info blocks:

  response = @bc.get_user_info([Bluevia::Schemas::DirectoryDataSets::USER_ACCESS_INFO, 
                                Bluevia::Schemas::DirectoryDataSets::USER_PROFILE])

DirectoryDataSets class is provided to ease user filtering.</pre>

<p>Code examples</p>

<pre>begin

      # 1. Create the client (you have to choose the mode and include the OAuth 
      # authorization values)
      @bc = BVDirectory.new(BVMode::LIVE, &quot;[CONSUMER_KEY]&quot;,&quot;[CONSUMER_SECRET]&quot;,
                                            &quot;[TOKEN_KEY]&quot;,&quot;[TOKEN_SECRET]&quot;) 

      # 2. Request user info. 
      response = @bc.get_user_info

      # 3. Process the response
      unless response.nil?
        personal_information = response.personal_info
        access_information   = response.access_info
        profile_information  = response.profile
        terminal_information = response.terminal_info
      end

rescue BlueviaError =&gt; e
      puts e.code
      puts e.message
      # as for example
end

Individual blocks can be obtained through its own method, as can be seen below:</pre>

<p>Methods for retrieving individual block information</p>

<pre>User can access four different blocks of information about target using DataSet 
filtering, but specific method for every block can be used as follows: 

  # To get User Access Info block
  # As with dataset USER_ACCESS_INFO
  # returns a Bluevia::Schemas::AccessInfo object

  response = @bc.get_access_info

  # To get User Profile Info block
  # As with dataset USER_PROFILE
  # returns a Bluevia::Schemas::Profile object      

  response = @bc.get_profile_info

  # To get User Terminal Info block
  # As with dataset USER_TERMINAL_INFO
  # returns a Bluevia::Schemas::TerminalInfo object

  response = @bc.get_terminal_info

  # To get User Personal Info block
  # As with dataset USER_PERSONAL_INFO
  # returns a Bluevia::Schemas::PersonalInfo object

  response = @bc.get_personal_info</pre>

<p>Using filters in requests</p>

<pre>Using those specific methods user can filter the information returned from 
the server using fields filtering in every method. This functionality consists 
on including as parameter an array of fields (different values for every method).

In case the user doesn't want to retrieve the whole block, there is an option 
to retrieve only a subset of the available information, using these filters. 

Next classes are provided to ease fields filtering:

   Bluevia::Schemas::AccessFields for get_access_info method
   Bluevia::Schemas::PersonalFields for get_personal_info
   Bluevia::Schemas::TerminalFields for get_terminal_info
   Bluevia::Schemas::ProfileFields for get_profile_info

   See next code examples:

   require 'bluevia/schemas'

   # get_access_info with fields filtering
   access_information = @bc.get_access_info([AccessFields::ACCESS_TYPE, 
                                         AccessFields::ROAMING])

   atype = access_information.access_type
   roam  = access_information.roaming

   # get_terminal_info with fields filtering
   terminal_information = @bc.get_terminal_info([TerminalFields::BRAND, 
                                             TerminalFields::EMS, 
                                             TerminalFields::SCREEN_RESOLUTION])
   brand_information = terminal_information.brand
   model_information = terminal_information.model # nil 
   ems_information = terminal_information.ems

   # get_profile_info with fields filtering
   profile_information = @bc.get_profile_info([ProfileFields::ICB, 
                                           ProfileFields::PARENTAL_CONTROL])
   icb_information = profile_information.icb
   parental_information = profile_information.parental_control

   # get_personal_info with fields filtering
   personal_information = @bc.get_personal_info([PersonalFields::GENDER])
   gender_information = personal_information.gender</pre>

  </div>

  <div id="validator-badges">
    <p><small><a href="http://validator.w3.org/check/referer">[Validate]</a></small></p>
    <p><small>Generated with the <a href="http://deveiate.org/projects/Darkfish-Rdoc/">Darkfish
      Rdoc Generator</a> 2</small>.</p>
  </div>
</body>
</html>

