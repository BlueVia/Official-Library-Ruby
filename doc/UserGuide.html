<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <meta content="text/html; charset=UTF-8" http-equiv="Content-Type" />

  <title>File: UserGuide [RDoc Documentation]</title>

  <link type="text/css" media="screen" href="./rdoc.css" rel="stylesheet" />

  <script src="./js/jquery.js" type="text/javascript"
    charset="utf-8"></script>
  <script src="./js/thickbox-compressed.js" type="text/javascript"
    charset="utf-8"></script>
  <script src="./js/quicksearch.js" type="text/javascript"
    charset="utf-8"></script>
  <script src="./js/darkfish.js" type="text/javascript"
    charset="utf-8"></script>
</head>

<body class="file">
  <div id="metadata">
    <div id="home-metadata">
      <div id="home-section" class="section">
        <h3 class="section-header">
          <a href="./index.html">Home</a>
          <a href="./index.html#classes">Classes</a>
          <a href="./index.html#methods">Methods</a>
        </h3>
      </div>
    </div>

    <div id="project-metadata">
      
      
      <div id="fileindex-section" class="section project-section">
        <h3 class="section-header">Files</h3>
        <ul>
        
          <li class="file"><a href="./Gemfile.html">Gemfile</a></li>
        
          <li class="file"><a href="./Rakefile.html">Rakefile</a></li>
        
          <li class="file"><a href="./UserGuide.html">UserGuide</a></li>
        
        </ul>
      </div>
      

      <div id="classindex-section" class="section project-section">
        <h3 class="section-header">Class Index
          <span class="search-toggle"><img src="./images/find.png"
            height="16" width="16" alt="[+]"
            title="show/hide quicksearch" /></span></h3>
        <form action="#" method="get" accept-charset="utf-8" class="initially-hidden">
        <fieldset>
          <legend>Quicksearch</legend>
          <input type="text" name="quicksearch" value=""
            class="quicksearch-field" />
        </fieldset>
        </form>

        <ul class="link-list">
        
          <li><a href="./Schemas.html">Schemas</a></li>
        
          <li><a href="./Schemas/Common_types.html">Schemas::Common_types</a></li>
        
          <li><a href="./Schemas/Common_types/AddressType.html">Schemas::Common_types::AddressType</a></li>
        
          <li><a href="./Schemas/Common_types/ClientExceptionType.html">Schemas::Common_types::ClientExceptionType</a></li>
        
          <li><a href="./Schemas/Common_types/ExtensionType.html">Schemas::Common_types::ExtensionType</a></li>
        
          <li><a href="./Schemas/Common_types/FlagType.html">Schemas::Common_types::FlagType</a></li>
        
          <li><a href="./Schemas/Common_types/GenderType.html">Schemas::Common_types::GenderType</a></li>
        
          <li><a href="./Schemas/Common_types/IpAddressType.html">Schemas::Common_types::IpAddressType</a></li>
        
          <li><a href="./Schemas/Common_types/OtherIdType.html">Schemas::Common_types::OtherIdType</a></li>
        
          <li><a href="./Schemas/Common_types/ServerExceptionType.html">Schemas::Common_types::ServerExceptionType</a></li>
        
          <li><a href="./Schemas/Common_types/SimpleReferenceType.html">Schemas::Common_types::SimpleReferenceType</a></li>
        
          <li><a href="./Schemas/Common_types/UserIdType.html">Schemas::Common_types::UserIdType</a></li>
        
          <li><a href="./Schemas/Directory_types.html">Schemas::Directory_types</a></li>
        
          <li><a href="./Schemas/Directory_types/AddressType.html">Schemas::Directory_types::AddressType</a></li>
        
          <li><a href="./Schemas/Directory_types/ClientExceptionType.html">Schemas::Directory_types::ClientExceptionType</a></li>
        
          <li><a href="./Schemas/Directory_types/ExtensionType.html">Schemas::Directory_types::ExtensionType</a></li>
        
          <li><a href="./Schemas/Directory_types/FlagType.html">Schemas::Directory_types::FlagType</a></li>
        
          <li><a href="./Schemas/Directory_types/GenderType.html">Schemas::Directory_types::GenderType</a></li>
        
          <li><a href="./Schemas/Directory_types/IpAddressType.html">Schemas::Directory_types::IpAddressType</a></li>
        
          <li><a href="./Schemas/Directory_types/MmsStatusType.html">Schemas::Directory_types::MmsStatusType</a></li>
        
          <li><a href="./Schemas/Directory_types/NameType.html">Schemas::Directory_types::NameType</a></li>
        
          <li><a href="./Schemas/Directory_types/OtherIdType.html">Schemas::Directory_types::OtherIdType</a></li>
        
          <li><a href="./Schemas/Directory_types/ServerExceptionType.html">Schemas::Directory_types::ServerExceptionType</a></li>
        
          <li><a href="./Schemas/Directory_types/SimpleReferenceType.html">Schemas::Directory_types::SimpleReferenceType</a></li>
        
          <li><a href="./Schemas/Directory_types/StatusType.html">Schemas::Directory_types::StatusType</a></li>
        
          <li><a href="./Schemas/Directory_types/SubscribedServiceType.html">Schemas::Directory_types::SubscribedServiceType</a></li>
        
          <li><a href="./Schemas/Directory_types/UserAccessInfoType.html">Schemas::Directory_types::UserAccessInfoType</a></li>
        
          <li><a href="./Schemas/Directory_types/UserIdType.html">Schemas::Directory_types::UserIdType</a></li>
        
          <li><a href="./Schemas/Directory_types/UserIdentitiesType.html">Schemas::Directory_types::UserIdentitiesType</a></li>
        
          <li><a href="./Schemas/Directory_types/UserInfoType.html">Schemas::Directory_types::UserInfoType</a></li>
        
          <li><a href="./Schemas/Directory_types/UserPersonalInfoType.html">Schemas::Directory_types::UserPersonalInfoType</a></li>
        
          <li><a href="./Schemas/Directory_types/UserProfileType.html">Schemas::Directory_types::UserProfileType</a></li>
        
          <li><a href="./Schemas/Directory_types/UserTerminalInfoType.html">Schemas::Directory_types::UserTerminalInfoType</a></li>
        
          <li><a href="./Schemas/Location_types.html">Schemas::Location_types</a></li>
        
          <li><a href="./Schemas/Location_types/AddressType.html">Schemas::Location_types::AddressType</a></li>
        
          <li><a href="./Schemas/Location_types/ClientExceptionType.html">Schemas::Location_types::ClientExceptionType</a></li>
        
          <li><a href="./Schemas/Location_types/CoordinatesType.html">Schemas::Location_types::CoordinatesType</a></li>
        
          <li><a href="./Schemas/Location_types/ExtensionType.html">Schemas::Location_types::ExtensionType</a></li>
        
          <li><a href="./Schemas/Location_types/FlagType.html">Schemas::Location_types::FlagType</a></li>
        
          <li><a href="./Schemas/Location_types/GenderType.html">Schemas::Location_types::GenderType</a></li>
        
          <li><a href="./Schemas/Location_types/IpAddressType.html">Schemas::Location_types::IpAddressType</a></li>
        
          <li><a href="./Schemas/Location_types/LocationDataType.html">Schemas::Location_types::LocationDataType</a></li>
        
          <li><a href="./Schemas/Location_types/LocationInfoType.html">Schemas::Location_types::LocationInfoType</a></li>
        
          <li><a href="./Schemas/Location_types/OtherIdType.html">Schemas::Location_types::OtherIdType</a></li>
        
          <li><a href="./Schemas/Location_types/RetrievalStatusType.html">Schemas::Location_types::RetrievalStatusType</a></li>
        
          <li><a href="./Schemas/Location_types/ServerExceptionType.html">Schemas::Location_types::ServerExceptionType</a></li>
        
          <li><a href="./Schemas/Location_types/ServiceErrorType.html">Schemas::Location_types::ServiceErrorType</a></li>
        
          <li><a href="./Schemas/Location_types/SimpleReferenceType.html">Schemas::Location_types::SimpleReferenceType</a></li>
        
          <li><a href="./Schemas/Location_types/TerminalLocationListType.html">Schemas::Location_types::TerminalLocationListType</a></li>
        
          <li><a href="./Schemas/Location_types/UserIdType.html">Schemas::Location_types::UserIdType</a></li>
        
          <li><a href="./Schemas/Mms_types.html">Schemas::Mms_types</a></li>
        
          <li><a href="./Schemas/Mms_types/AddressType.html">Schemas::Mms_types::AddressType</a></li>
        
          <li><a href="./Schemas/Mms_types/ClientExceptionType.html">Schemas::Mms_types::ClientExceptionType</a></li>
        
          <li><a href="./Schemas/Mms_types/DeliveryInformationType.html">Schemas::Mms_types::DeliveryInformationType</a></li>
        
          <li><a href="./Schemas/Mms_types/DeliveryReceiptNotificationType.html">Schemas::Mms_types::DeliveryReceiptNotificationType</a></li>
        
          <li><a href="./Schemas/Mms_types/DeliveryStatusType.html">Schemas::Mms_types::DeliveryStatusType</a></li>
        
          <li><a href="./Schemas/Mms_types/DeliveryStatusUpdateType.html">Schemas::Mms_types::DeliveryStatusUpdateType</a></li>
        
          <li><a href="./Schemas/Mms_types/ExtensionType.html">Schemas::Mms_types::ExtensionType</a></li>
        
          <li><a href="./Schemas/Mms_types/FlagType.html">Schemas::Mms_types::FlagType</a></li>
        
          <li><a href="./Schemas/Mms_types/GenderType.html">Schemas::Mms_types::GenderType</a></li>
        
          <li><a href="./Schemas/Mms_types/IpAddressType.html">Schemas::Mms_types::IpAddressType</a></li>
        
          <li><a href="./Schemas/Mms_types/MessageDeliveryStatusType.html">Schemas::Mms_types::MessageDeliveryStatusType</a></li>
        
          <li><a href="./Schemas/Mms_types/MessageNotificationType.html">Schemas::Mms_types::MessageNotificationType</a></li>
        
          <li><a href="./Schemas/Mms_types/MessagePriorityType.html">Schemas::Mms_types::MessagePriorityType</a></li>
        
          <li><a href="./Schemas/Mms_types/MessageReferenceType.html">Schemas::Mms_types::MessageReferenceType</a></li>
        
          <li><a href="./Schemas/Mms_types/MessageType.html">Schemas::Mms_types::MessageType</a></li>
        
          <li><a href="./Schemas/Mms_types/MessageURIType.html">Schemas::Mms_types::MessageURIType</a></li>
        
          <li><a href="./Schemas/Mms_types/OtherIdType.html">Schemas::Mms_types::OtherIdType</a></li>
        
          <li><a href="./Schemas/Mms_types/ReceivedMessageAsyncType.html">Schemas::Mms_types::ReceivedMessageAsyncType</a></li>
        
          <li><a href="./Schemas/Mms_types/ReceivedMessagesType.html">Schemas::Mms_types::ReceivedMessagesType</a></li>
        
          <li><a href="./Schemas/Mms_types/ServerExceptionType.html">Schemas::Mms_types::ServerExceptionType</a></li>
        
          <li><a href="./Schemas/Mms_types/SimpleReferenceType.html">Schemas::Mms_types::SimpleReferenceType</a></li>
        
          <li><a href="./Schemas/Mms_types/UserIdType.html">Schemas::Mms_types::UserIdType</a></li>
        
          <li><a href="./Schemas/Payment_types.html">Schemas::Payment_types</a></li>
        
          <li><a href="./Schemas/Payment_types/ErrorType.html">Schemas::Payment_types::ErrorType</a></li>
        
          <li><a href="./Schemas/Payment_types/GetPaymentStatusParamsType.html">Schemas::Payment_types::GetPaymentStatusParamsType</a></li>
        
          <li><a href="./Schemas/Payment_types/GetPaymentStatusResultType.html">Schemas::Payment_types::GetPaymentStatusResultType</a></li>
        
          <li><a href="./Schemas/Payment_types/IpAddressType.html">Schemas::Payment_types::IpAddressType</a></li>
        
          <li><a href="./Schemas/Payment_types/MethodCallType.html">Schemas::Payment_types::MethodCallType</a></li>
        
          <li><a href="./Schemas/Payment_types/MethodCallType_.html">Schemas::Payment_types::MethodCallType_</a></li>
        
          <li><a href="./Schemas/Payment_types/MethodCallType_/Params.html">Schemas::Payment_types::MethodCallType_::Params</a></li>
        
          <li><a href="./Schemas/Payment_types/MethodResponseType.html">Schemas::Payment_types::MethodResponseType</a></li>
        
          <li><a href="./Schemas/Payment_types/MethodResponseType_.html">Schemas::Payment_types::MethodResponseType_</a></li>
        
          <li><a href="./Schemas/Payment_types/MethodResponseType_/Result.html">Schemas::Payment_types::MethodResponseType_::Result</a></li>
        
          <li><a href="./Schemas/Payment_types/MethodType.html">Schemas::Payment_types::MethodType</a></li>
        
          <li><a href="./Schemas/Payment_types/NotifyPaymentFinalStatusParamsType.html">Schemas::Payment_types::NotifyPaymentFinalStatusParamsType</a></li>
        
          <li><a href="./Schemas/Payment_types/OtherIdType.html">Schemas::Payment_types::OtherIdType</a></li>
        
          <li><a href="./Schemas/Payment_types/PaymentInfoType.html">Schemas::Payment_types::PaymentInfoType</a></li>
        
          <li><a href="./Schemas/Payment_types/PaymentParamsType.html">Schemas::Payment_types::PaymentParamsType</a></li>
        
          <li><a href="./Schemas/Payment_types/PaymentResultType.html">Schemas::Payment_types::PaymentResultType</a></li>
        
          <li><a href="./Schemas/Payment_types/SimpleReferenceType.html">Schemas::Payment_types::SimpleReferenceType</a></li>
        
          <li><a href="./Schemas/Payment_types/TransactionEnumerationType.html">Schemas::Payment_types::TransactionEnumerationType</a></li>
        
          <li><a href="./Schemas/Payment_types/UserIdType.html">Schemas::Payment_types::UserIdType</a></li>
        
          <li><a href="./Schemas/Sms_types.html">Schemas::Sms_types</a></li>
        
          <li><a href="./Schemas/Sms_types/AddressType.html">Schemas::Sms_types::AddressType</a></li>
        
          <li><a href="./Schemas/Sms_types/ClientExceptionType.html">Schemas::Sms_types::ClientExceptionType</a></li>
        
          <li><a href="./Schemas/Sms_types/DeliveryInformationType.html">Schemas::Sms_types::DeliveryInformationType</a></li>
        
          <li><a href="./Schemas/Sms_types/DeliveryStatusType.html">Schemas::Sms_types::DeliveryStatusType</a></li>
        
          <li><a href="./Schemas/Sms_types/ExtensionType.html">Schemas::Sms_types::ExtensionType</a></li>
        
          <li><a href="./Schemas/Sms_types/FlagType.html">Schemas::Sms_types::FlagType</a></li>
        
          <li><a href="./Schemas/Sms_types/GenderType.html">Schemas::Sms_types::GenderType</a></li>
        
          <li><a href="./Schemas/Sms_types/IpAddressType.html">Schemas::Sms_types::IpAddressType</a></li>
        
          <li><a href="./Schemas/Sms_types/OtherIdType.html">Schemas::Sms_types::OtherIdType</a></li>
        
          <li><a href="./Schemas/Sms_types/ReceivedSMSAsyncType.html">Schemas::Sms_types::ReceivedSMSAsyncType</a></li>
        
          <li><a href="./Schemas/Sms_types/ReceivedSMSType.html">Schemas::Sms_types::ReceivedSMSType</a></li>
        
          <li><a href="./Schemas/Sms_types/SMSDeliveryStatusType.html">Schemas::Sms_types::SMSDeliveryStatusType</a></li>
        
          <li><a href="./Schemas/Sms_types/SMSDeliveryStatusUpdateType.html">Schemas::Sms_types::SMSDeliveryStatusUpdateType</a></li>
        
          <li><a href="./Schemas/Sms_types/SMSMessageType.html">Schemas::Sms_types::SMSMessageType</a></li>
        
          <li><a href="./Schemas/Sms_types/SMSNotificationType.html">Schemas::Sms_types::SMSNotificationType</a></li>
        
          <li><a href="./Schemas/Sms_types/SMSTextType.html">Schemas::Sms_types::SMSTextType</a></li>
        
          <li><a href="./Schemas/Sms_types/ServerExceptionType.html">Schemas::Sms_types::ServerExceptionType</a></li>
        
          <li><a href="./Schemas/Sms_types/SimpleReferenceType.html">Schemas::Sms_types::SimpleReferenceType</a></li>
        
          <li><a href="./Schemas/Sms_types/UserIdType.html">Schemas::Sms_types::UserIdType</a></li>
        
          <li><a href="./Bluevia.html">Bluevia</a></li>
        
          <li><a href="./Bluevia/AdResponse.html">Bluevia::AdResponse</a></li>
        
          <li><a href="./Bluevia/Advertising.html">Bluevia::Advertising</a></li>
        
          <li><a href="./Bluevia/Attach.html">Bluevia::Attach</a></li>
        
          <li><a href="./Bluevia/Attach/Attachment.html">Bluevia::Attach::Attachment</a></li>
        
          <li><a href="./Bluevia/BaseClient.html">Bluevia::BaseClient</a></li>
        
          <li><a href="./Bluevia/BlueviaClient.html">Bluevia::BlueviaClient</a></li>
        
          <li><a href="./Bluevia/ClientError.html">Bluevia::ClientError</a></li>
        
          <li><a href="./Bluevia/Directory.html">Bluevia::Directory</a></li>
        
          <li><a href="./Bluevia/Errors.html">Bluevia::Errors</a></li>
        
          <li><a href="./Bluevia/Location.html">Bluevia::Location</a></li>
        
          <li><a href="./Bluevia/Messaging.html">Bluevia::Messaging</a></li>
        
          <li><a href="./Bluevia/Mms.html">Bluevia::Mms</a></li>
        
          <li><a href="./Bluevia/NotFoundError.html">Bluevia::NotFoundError</a></li>
        
          <li><a href="./Bluevia/Oauth.html">Bluevia::Oauth</a></li>
        
          <li><a href="./Bluevia/OauthPayment.html">Bluevia::OauthPayment</a></li>
        
          <li><a href="./Bluevia/Payment.html">Bluevia::Payment</a></li>
        
          <li><a href="./Bluevia/Response.html">Bluevia::Response</a></li>
        
          <li><a href="./Bluevia/Schemas.html">Bluevia::Schemas</a></li>
        
          <li><a href="./Bluevia/ServerError.html">Bluevia::ServerError</a></li>
        
          <li><a href="./Bluevia/ServicesFactory.html">Bluevia::ServicesFactory</a></li>
        
          <li><a href="./Bluevia/Sms.html">Bluevia::Sms</a></li>
        
          <li><a href="./Bluevia/Utils.html">Bluevia::Utils</a></li>
        
          <li><a href="./Bluevia/Utils/Multipart.html">Bluevia::Utils::Multipart</a></li>
        
          <li><a href="./OAuth.html">OAuth</a></li>
        
          <li><a href="./OAuth/Client.html">OAuth::Client</a></li>
        
          <li><a href="./OAuth/Client/Helper.html">OAuth::Client::Helper</a></li>
        
          <li><a href="./Rack.html">Rack</a></li>
        
          <li><a href="./Rack/Multipart.html">Rack::Multipart</a></li>
        
          <li><a href="./Rack/Multipart/Parser.html">Rack::Multipart::Parser</a></li>
        
          <li><a href="./BlueviaLogger.html">BlueviaLogger</a></li>
        
          <li><a href="./Hash.html">Hash</a></li>
        
          <li><a href="./Multipartable.html">Multipartable</a></li>
        
        </ul>
        <div id="no-class-search-results" style="display: none;">No matching classes.</div>
      </div>

      
    </div>
  </div>

  <div id="documentation">
    
<p><a href="Bluevia.html">Bluevia</a> client module definition</p>

<p>Introduction</p>

<pre>Bluevia Ruby SDK allows you to use the BueVia public API from your Ruby
application using just a few lines of code.
You only need to download the SDK, include it into your LOAD_PATH directory
and leave magic work for you. If you download the gem this should be
automatically included in your gem local repository.

When you want to use as developer Bluevia public APIs,
first of all you need to get a commercial or testing API Key.

Ruby SDK wraps any request to BlueVia endpoint by using a generic object
BlueviaClient. This object uses the Component Pattern to fetch any service
required by the developer (oAuth, SMS or Directory).</pre>

<p>Getting Started</p>

<pre>Find below the gem dependencies required by Bluevia SDK:

 - httpclient: used to create HTTP requests
 - oauth: generic gem to launch the oAuth process
 - nokogiri: used to parse XML responses (Advertising)
 - json_pure: used to parse JSON responses
 - multipart-post : used to send multipart MMS
 - multipart_body : used to prepare multipart bodys for MMS
 - mime-types : used to encode mime data
 - rack : used to parse multipart MMS

This snippet shows the easier way to create a new object with valid credentials
that identify the application:

    require 'rubygems'
    require 'bluevia'
    include Bluevia

    @bc = BlueviaClient.new(
       { :consumer_key   =&gt; CONSUMER_KEY,
         :consumer_secret=&gt; CONSUMER_SECRET,
         :uri            =&gt; &quot;https://api.bluevia.com&quot;
       })</pre>

<p>Endpoints</p>

<pre>BlueVia has two endpoints, commercial and sandbox.
Commercial is linked to Telefonica network, and sandbox is used just to
verify application behavior.
The developer can change the endpoint just setting the desired behavior
in the client:

   @bc.set_commercial
   @bc.set_sandbox

Use the method @bc.commercial? to verify if the client is accessing either
commercial or sandbox endpoint.</pre>

<p>Using Oauth</p>

<pre>User authentication is launched using oAuth protocol, so user is not
required to use credentials in third party applications.
If you want to learn more about oAuth please check this URL: http://oauth.net.

When user wants to launch the oAuth process, once the Bluevia client object
has been created only the two lines below are required to retrieve 
a valid token for user:

    @service = @bc.get_service(:oAuth)
    token, secret, url = @service.get_request_token({:callback =&gt;&quot;http://foo.bar&quot;})

Note that :callback is an optional parameter. 
If it's defined you will receive the oauth_verifier as a request parameter at your 
callback_url. 
If it's not defined you will have to ask the user to enter the PIN code (oauth_verifier) 
in your application.
Finally in case :callback parameter is provided, it can also be a string with an msisdn 
as follows:

    token, secret, url = @service.get_request_token(&quot;34567890&quot;)

The retrieved parameter token and secret should be used during the oAuth
process, and url is the endpoint where Bluevia shall authenticate the user.
In case of a Rails application, the lines below could be used:

    token, token_secret, url = @service.get_request_token(
                            &quot;http://foo.bar/bluevia/get_access&quot;)
    cookies[:token] = &quot;#{token}|#{token_secret}&quot;
    redirect_to(url)

Both tokend and token_secret must be saved by the application provider
because oAuth process will require it later.

Once user is authenticated and she has authorized the application in 
BlueVia portal, she should be redirected to the URL used as parameter before.
Now it's time to fetch the valid token and token secret that shall identify
the new user during any call to BlueVia API. Lines below show an example using Rails:

    def get_access
        oauth_verifier = params[:oauth_verifier]
        get_token_from_cookie
        @bc = BlueviaClient.new(
        { :consumer_key   =&gt; CONSUMER_KEY,
          :consumer_secret=&gt; CONSUMER_SECRET
        })
        @service = @bc.get_service(:oAuth)
        @token, @token_secret = @service.get_access_token(@request_token, @request_secret, oauth_verifier)
    end

    private
        def get_token_from_cookie
            cookie_token = cookies[:token]
            unless cookie_token.nil?
            cookie_token = cookie_token.split(&quot;|&quot;)
            if cookie_token.size != 2
                raise SyntaxError, &quot;The cookie is not valid&quot;
            end
            @request_token = cookie_token[0]
            @request_secret = cookie_token[1]
        end
    end</pre>

<p>Using BlueviaClient to launch requests</p>

<pre>Most of requests when accessing Bluevia API are associated to a specific user,
so when a BlueviaClient object is created both user token and 
user token secret must be provided to identify user on behalf of
whom the application wants to access BlueVia APIs.

    @bc = BlueviaClient.new(
       { :consumer_key   =&gt; CONSUMER_KEY,
         :consumer_secret=&gt; CONSUMER_SECRET,
         :token          =&gt; USER_TOKEN,
         :token_secret   =&gt; TOKEN_SECRET,
         :uri            =&gt; &quot;https://api.bluevia.com&quot;
       })

For two-legged oauth authentication use this alternative BlueviaClient object creation method.

    @bc = BlueviaClient.new(
       { :consumer_key   =&gt; CONSUMER_KEY,
         :consumer_secret=&gt; CONSUMER_SECRET,
         :uri            =&gt; &quot;https://api.bluevia.com&quot;
       })</pre>

<p>Send a SMS</p>

<pre>First of all, create the BlueviaClient object as shown before.

Any operation available in BlueviaClient object is associated to 
a specific service. Each service represents a specific enabler provided by Bluevia.

In case of SMS, these two lines are required to send a SMS on behalf of the user:
    @service = @bc.get_service(:Sms)
    info = @service.send(DESTINATIONS, TEXT)

Or with some optional parameters:
        - endpoint for notifications
        - correlator for notifications   
    info = @service.send(DESTINATIONS, TEXT, ENDPOINT, CORRELATOR)</pre>

<p>Send a MMS</p>

<pre>Use the following lines to send a MMS message.
    @service = @bc.get_service(:Mms)
    info = @service.send(DESTINATIONS)

With some optional parameters:
        - multimedia file attachments. Valid content types :
              text/plain image/jpeg image/bmp image/gif image/png audio/amr audio/midi
              audio/mp3 audio/mpeg audio/wav video/mp4 video/avi video/3gpp 
        - text body
        - text subject
        - endpoint for notifications
        - correlator for notifications
        - activation flag for uri notification sending   

    attach = Array.new
    attach &lt;&lt; Attach::Attachment.new( FILEPATH1, MIMETYPE1 )
    attach &lt;&lt; Attach::Attachment.new( FILEPATH2, MIMETYPE2 )
    info = @service.send(DESTINATIONS, attach, BODY, SUBJECT, GETURI_FLAG)

One attachment sending also allowed

    attach = Attach::Attachment.new( FILEPATH1, MIMETYPE1 )
    info = @service.send(DESTINATIONS, attach, BODY, SUBJECT, GETURI_FLAG)</pre>

<p>MO Services</p>

<pre>Both SMS and MMS capabilities can be used to received messages from user,
what is known as Mobile Originated operations.

To receive SMS or MMS is required to start the notification system:

   info = @service.start_mms_notification( VALID_REGISTRATION_ID,
                                            URL_TO_GET_NOTIFICATIONS,
                                            &quot;correlator_id&quot;,
                                            SMS_MMS_VALID_KEYWORD) 

Or use the following lines to get received messages

    messages = @service.get_messages(COUNTRY_SPECIAL_SHORT_CODE_NUMBER)
    message_id = messages[&quot;messageIdentifier&quot;]
    message = @service.get_message(COUNTRY_SPECIAL_SHORT_CODE_NUMBER, message_id)

The result message object is a hash with this kind of structure :

   {
     &quot;root-fields&quot;=&gt;
     {
       :type=&gt;&quot;application/json;charset=UTF-8&quot;,
       :name=&gt;&quot;root-fields&quot;,
       :tempfile=&gt;&quot;{\&quot;message\&quot;:{\&quot;address\&quot;:[{\&quot;phoneNumber\&quot;:\&quot;1234567\&quot;}],\&quot;originAddress\&quot;
         :{\&quot;alias\&quot;:\&quot;F70CD99201189AD2FEF3F5A23DF60349\&quot;},\&quot;subject\&quot;:\&quot;MOKEYWORD\&quot;}}&quot;,
       :head=&gt;&quot;Content-Disposition: form-data; name=\&quot;root-fields\&quot;\r\nContent-Type: application
         /json;charset=UTF-8\r\nContent-ID: &lt;0.urn:uuid:638C7523F3BEC3AFDA1222262695929@apache.org&gt;\r\n&quot;
     },
     &quot;attachments&quot;=&gt;
     {
       &quot;&lt;2&gt;&quot; =&gt;
       {
         :type =&gt; &quot;text/plain&quot;,
         :name =&gt; &quot;&lt;2&gt;&quot;,
         :tempfile =&gt; &quot;Hola caracola&quot;,
         :head =&gt; &quot;Content-Type: text/plain\r\nContent-Transfer-Encoding: binary\r\nContent-ID: &lt;2&gt;\r\n&quot;
       },
       &quot;&lt;3&gt;&quot; =&gt;
       {
         :type =&gt; &quot;image/jpeg;charset=UTF-8&quot;,
         :name =&gt; &quot;&lt;3&gt;&quot;,
         :tempfile =&gt; &quot;\xFF\xD8\xFF\xE0\x00\x10JFIF\x00\x01\x01 ...&quot;,
         :head =&gt; &quot;Content-Type: audio/midi;charset=UTF-8\r\nContent-Transfer-Encoding: 
           binary\r\nContent-ID: &lt;4&gt;\r\n
       }
       ...
     }
   }</pre>

<p>Request Directory Info</p>

<pre>Use these lines to get user info
    @service = @bc.get_service(:Directory)
    response = @service.get_user_info()

Or with optional parameter to get specfic user info:
    response = @service.get_user_info(TYPE)

Here it's a sample:
    response = @service.get_user_info(Directory::USER_IDENTITIES)</pre>

<p>Get Ad</p>

<pre>With Advertising API a developer can fetch an ad to include in her application.
Two-legged oauth authentication is allowed with this API. Thus, please use the alternative BlueviaClient
creation method as showed above.

There are some required parameters:
       - user_agent
       - ad_request_id
       - ad_space

And also optional parameters:
       - ad_presentation
       - ad_presentation_size
       - keywords
       - protection_policy
       - country (It's a required parameter if two-legged oauth authentication is choosen. ISO-3166)

All parameters should be include in a single Hash object:
    @service = @bc.get_service(:Advertising)
    params = {
       :user_agent =&gt; AGENT,
       :ad_request_id =&gt; RANDOMSTRING_OR_EMPTY_STRING,
       :ad_space =&gt; ADSPACE,
    }
    ad = @service.request(params)

Here it's a sample:
    params = 
    {
        :user_agent =&gt; &quot;Mozilla 5.0&quot;,
        :ad_request_id =&gt; &quot;a1x4zasg58&quot;,
        :ad_space =&gt; &quot;1200&quot;,
        :keywords =&gt; &quot;bar&quot;
    }
    ad = @service.request(params)</pre>

<p>Location</p>

<pre>With Location API, a developer can fetch his location to include it in the application
There is an optional parameter :
       - acc_accuracy - Accuracy that is acceptable for a response

    @service = @bc.get_service(:Location)
    location = @service.get_location(acc_accuracy)</pre>

<p>Payment</p>

<pre>With Payment API. a developer can make payments on a specific payment service supported
by Bluevia infrastructure.
There is a special kind of three ledged oAuth authorization system for this api. It's actually
integrated in the Bluevia SDK client for payment, so you don't have to use the Bluevia SDK oAuth
client. For this process you have to provide the exact payment information.

    @service = @bc.get_service(:Payment)
    paymentInfo = Schemas::Payment_types::PaymentInfoType.new(amount, currency)
    params = {
      :callback =&gt; &quot;oob&quot;,
      :paymentInfo =&gt; paymentInfo,
      :name =&gt; SERVICEINFO_NAME,
      :serviceID =&gt; SERVICEINFO_SERVICEID
    }
    request_token, request_secret, url = @service.get_payment_request_token( params )

This time :callback can't be a msisdn but is still an optional parameter.

The result includes the request token and token secret, and the user authorization url, in
order to get the user pin code. You can also provide a callback for automatic redirection,
for web implementation. Request token and token secret are also kept inside the client for
convenience when calling the following process of getting access token and secret.  

    params = { :pin =&gt; USER_PIN_CODE, 
      :token =&gt; request_token, 
      :token_secret=&gt; request_secret}
    result = @service.get_payment_access_token( params )

Request tokens are preserved for 48 hours, untill used in a payment request or cancelled. Hence
developer alternatively may create another Bluevia SDK payment client and use this call to get
the access token information.

It's possible to make just one payment for every token.

    pInfo = Schemas::Payment_types::PaymentInfoType.new(amount, currency)
    result= Schemas::Payment_types::PaymentResultType.new()
    result = @service.payment({:paymentInfo =&gt; pInfo})

Then the developer may use the :transactionId parameter received in the result to get the status
information of the transactionId

    result =Schemas::Payment_types::GetPaymentStatusResultType.new()
    result = @service.get_payment_status( TRANSACTION_ID )

If the token is no longer needed it's also possible to cancel the authorization

    result = @service.cancel_authorization()</pre>

  </div>

  <div id="validator-badges">
    <p><small><a href="http://validator.w3.org/check/referer">[Validate]</a></small></p>
    <p><small>Generated with the <a href="http://deveiate.org/projects/Darkfish-Rdoc/">Darkfish
      Rdoc Generator</a> 2</small>.</p>
  </div>
</body>
</html>

